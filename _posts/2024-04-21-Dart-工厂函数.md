---
layout: post
title:  "Dart学习：工厂函数"
categories: Dart
tags: 库类接口继承
author: MLM
---
# [工厂函数](https://ducafecat.com/course/dart-learn/dart-22-factory#%E5%B7%A5%E5%8E%82%E5%87%BD%E6%95%B0)

## [调用子类](https://ducafecat.com/course/dart-learn/dart-22-factory#%E8%B0%83%E7%94%A8%E5%AD%90%E7%B1%BB)

```dart
abstract class Phone {
  void call();
  factory Phone(String type) {
    switch (type) {
      case "android":
        return Android();
      case "ios":
        return Ios();
      default:
        throw "The '$type' is not an animal";
    }
  }
}

class Android implements Phone {
  @override
  void call() {
    print('Android Calling...');
  }
}

class Ios implements Phone {
  @override
  void call() {
    print('Ios Calling...');
  }
}

void main() {
  var android = Phone('android');
  var ios = Phone('ios');
  android.call();
  ios.call();
}
```

## [单例模式](https://ducafecat.com/course/dart-learn/dart-22-factory#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F)

```dart
class Phone {
  static final Phone _single = Phone._internal();
  Phone._internal();

  factory Phone() {
    return _single;
  }

  void call() {
    print('Calling...');
  }
}

void main() {
  var p1 = Phone();
  var p2 = Phone();
  print(identical(p1, p2));

  Phone().call();
}
```

## [减少重复实例对象](https://ducafecat.com/course/dart-learn/dart-22-factory#%E5%87%8F%E5%B0%91%E9%87%8D%E5%A4%8D%E5%AE%9E%E4%BE%8B%E5%AF%B9%E8%B1%A1)

```dart
class Phone {
  int _number;
  Phone(this._number);

  factory Phone.fromJson(Map<String, dynamic> json) =>
      Phone(json['number'] as int);

  void call() {
    print('Calling $_number...');
  }
}

void main() {
  var p = Phone.fromJson({"number": 911});
  p.call();
}
```

> 如果不用工厂函数，就要用类静态方法，这样会有多余的实例对象
>
